<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="Favicon.png" type="image/x-icon">
<link rel="shortcut icon" href="Favicon.png" type="image/x-icon">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MEE69 - FR3D - Clan Rankings</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&family=Roboto:wght@400;500&display=swap');
    </style>
</head>
<body class="font-roboto bg-gradient-to-br from-gray-200 to-gray-100 text-gray-800">

    <header class="bg-gray-800 text-white px-10 py-5 flex justify-between items-center shadow-lg">
        <div class="logo">
            <h1 class="text-2xl font-poppins font-bold">MEE69 - FR3D</h1>
        </div>
        <nav>
            <ul class="flex gap-5">
                <!-- Navigation links can be added here -->
            </ul>
        </nav>
    </header>

    <main>
        <div class="container max-w-3xl mx-auto mt-10 p-5 bg-white/30 rounded-xl shadow-lg backdrop-blur-sm border border-gray-300">
            <div class="flex flex-col items-center text-center"> <!-- Centering the content -->
            <h2 class="text-2xl font-poppins font-semibold text-gray-800">Crab Battle</h2>
            <p>Battle start: Saturday, Aug 31, 2024 at 6:00 PM (UTC+2)</p>
            <p>Battle Finished: Friday, Sep 13, 2024 at 6:00 PM (UTC+2)</p>
            <button class="reward-button bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg shadow-md mt-4" onclick="openModal()">Placement Rewards</button>

            <div class="tabs flex items-center gap-4 flex-wrap mt-6">
                <button class="tab-button bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg shadow-md active" onclick="showTab('clans')">Clans</button>
                <input type="text" id="searchInput" placeholder="Search for a clan" maxlength="4" class="px-4 py-3 border border-gray-300 rounded-lg shadow-inner focus:border-blue-600 focus:outline-none">
                <button class="search-button bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg shadow-md" onclick="searchClan()">Search</button>
            </div>

            <div class="error-message text-red-500 mt-2" id="errorMessage"></div>
            <table class="w-full border-collapse mt-5">
                <thead>
                    <tr class="bg-blue-600 text-white font-semibold">
                        <th class="px-4 py-2 w-1/6">Place</th> <!-- Adjust width of Place column -->
                        <th class="px-4 py-2 w-2/6">Name</th>
                        <th class="px-4 py-2 w-1/6">Points</th>
                        <th class="px-4 py-2 w-1/6">Members</th>
                    </tr>
                </thead>
                <tbody id="clanData">
                    <!-- Example rows -->
                    <tr class="border-b hover:bg-blue-50">
                        <td class="px-4 py-2">1</td>
                        <td class="px-4 py-2"><img src="https://example.com/icon1.png" class="w-9 h-9 rounded-full inline-block mr-2" alt="Icon"> Icon MREQ</td>
                        <td class="px-4 py-2">71700</td>
                        <td class="px-4 py-2">75</td>
                    </tr>
                    <!-- More rows... -->
                </tbody>
            </table>
            

            <div id="players" class="tab-content hidden">
                <!-- Player data table can go here -->
            </div>
        </div>
    </main>

    <div id="rewardsModal" class="modal hidden fixed inset-0 z-50 bg-black bg-opacity-60 flex items-center justify-center">
        <div class="modal-content bg-white rounded-xl shadow-lg p-8 max-w-md mx-auto">
            <span class="close text-gray-800 float-right text-2xl cursor-pointer hover:text-red-600" onclick="closeModal()">&times;</span>
            <h3 class="text-3xl font-poppins font-bold text-blue-600 mb-6">Placement Rewards</h3>
            <ul class="list-disc list-inside space-y-4 pl-5">
                <li class="text-lg">Clan Gift - Top 500</li>
                <li class="text-lg">Rave Crab Booth - Top 50</li>
                <li class="text-lg">Rave Crab Hoverboard - Top 10</li>
                <li class="text-lg">Rainbow Huge Rave Crab - Top 1</li>
                <li class="text-lg">Golden Huge Rave Crab - Top 2-3</li>
                <li class="text-lg">Huge Rave Crab - Top 4 to 10</li>
            </ul>
        </div>
    </div>
    
    
    

    <script>
        var apiUrl = 'https://biggamesapi.io/api/clans?page=1&pageSize=100&sort=Points&sortOrder=desc';
        var allClans = [];
        var searchPage = 1;

        function fetchClanData() {
            var xhr = new XMLHttpRequest();
            xhr.open('GET', apiUrl, true);

            xhr.onload = function() {
                if (xhr.status === 200) {
                    var response = JSON.parse(xhr.responseText);
                    if (response && response.status === 'ok' && Array.isArray(response.data)) {
                        allClans = response.data;
                        displayClans(allClans);
                    } else {
                        console.error('Unexpected API response structure');
                    }
                } else {
                    console.error('API request failed');
                }
            };

            xhr.send();
        }

        function searchClan() {
            var clanName = document.getElementById('searchInput').value.trim();
            if (clanName.length < 1 || clanName.length > 4) {
                document.getElementById('errorMessage').innerText = 'Clan name must be between 1 and 4 characters.';
                return;
            }

            searchPage = 1;
            document.getElementById('errorMessage').innerText = '';

            function fetchAndSearch() {
                var xhr = new XMLHttpRequest();
                xhr.open('GET', `https://biggamesapi.io/api/clans?page=${searchPage}&pageSize=1000&sort=Points&sortOrder=desc`, true);

                xhr.onload = function() {
                    if (xhr.status === 200) {
                        var response = JSON.parse(xhr.responseText);
                        if (response && response.status === 'ok' && Array.isArray(response.data)) {
                            var clans = response.data;
                            var found = false;

                            for (var i = 0; i < clans.length; i++) {
                                if (clans[i].Name.toLowerCase() === clanName.toLowerCase()) {
                                    var rank = (searchPage - 1) * 1000 + i + 1;
                                    displayClans([clans[i]], rank);
                                    document.getElementById('errorMessage').innerText = '';
                                    found = true;
                                    break;
                                }
                            }

                            if (!found) {
                                if (clans.length === 0) {
                                    document.getElementById('errorMessage').innerText = 'Clan does not exist.';
                                } else {
                                    searchPage++;
                                    fetchAndSearch();
                                }
                            }
                        } else {
                            console.error('Unexpected API response structure');
                        }
                    } else {
                        console.error('API request failed');
                    }
                };

                xhr.send();
            }

            fetchAndSearch();
        }

        function displayClans(clans, rank = null) {
            var clanData = document.getElementById('clanData');
            clanData.innerHTML = '';
            clans.forEach(function(clan, index) {
                var place = rank !== null ? rank : index + 1;
                var row = document.createElement('tr');
                row.innerHTML = `
                    <td class="p-4 border border-gray-300">${place}</td>
                    <td class="p-4 border border-gray-300"><img src="${clan.Icon.replace('rbxassetid://', 'https://biggamesapi.io/image/')}" class="w-9 h-9 rounded-full inline-block mr-3" alt="Icon"> ${clan.Name}</td>
                    <td class="p-4 border border-gray-300">${clan.Points}</td>
                    <td class="p-4 border border-gray-300">${clan.Members + 1}</td>
                `;
                clanData.appendChild(row);
            });
        }

        function showTab(tabId) {
            var tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(function(tab) {
                tab.classList.add('hidden');
                tab.classList.remove('block');
            });

            document.getElementById(tabId).classList.remove('hidden');
            document.getElementById(tabId).classList.add('block');

            var buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(function(button) {
                button.classList.remove('active');
            });

            document.querySelector(`.tab-button[onclick="showTab('${tabId}')"]`).classList.add('active');
        }

        function openModal() {
            document.getElementById('rewardsModal').classList.remove('hidden');
            document.getElementById('rewardsModal').classList.add('flex');
        }

        function closeModal() {
            document.getElementById('rewardsModal').classList.remove('flex');
            document.getElementById('rewardsModal').classList.add('hidden');
        }

        document.addEventListener('DOMContentLoaded', function() {
            fetchClanData();
        });
    </script>
</body>
</html>
